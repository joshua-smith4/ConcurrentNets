import matplotlib.pyplot as plt
import numpy as np

x = [
    1024,
    2048,
    3072,
    4096,
    5120,
    6144,
    7168,
    8192,
    9216,
    10240,
    11264,
    12288,
    13312,
    14336,
    15360,
    16384,
    17408,
    18432,
    19456,
    20480,
    22528,
    24576,
    26624,
    28672,
    30720,
    32768,
    34816,
    36864,
    38912,
    40960,
    43008,
    45056,
    47104,
    49152,
    51200,
    61440,
    71680,
    81920,
    92160,
    102400,
    204800,
    307200,
    409600,
    512000,
    614400,
    716800,
    819200,
    921600,
    1024000,
    1126400,
    2174976,
    3223552,
    4272128,
    5320704,
    6369280,
    7417856,
    8466432,
    9515008,
    10563584,
    11612160,
    12660736,
    13709312,
    14757888,
    15806464,
    16855040,
    18952192,
    21049344,
    23146496,
    25243648,
    27340800,
    29437952,
    31535104,
    33632256,
    37826560,
    42020864,
    46215168,
    50409472,
    54603776,
    58798080,
    62992384,
    67186688,
]

dtoh = [
    438.8,
    894.5,
    1328.7,
    1690.6,
    2238.5,
    2572.7,
    3087.9,
    3348.1,
    3738.5,
    4023.4,
    4257.5,
    4549.3,
    4744.2,
    4955.8,
    5153.4,
    5332.8,
    5508.0,
    5678.4,
    5827.4,
    5944.5,
    6256.8,
    6489.6,
    6577.9,
    6941.7,
    7142.3,
    7324.9,
    7505.7,
    7601.9,
    7818.2,
    7960.3,
    8018.7,
    8209.4,
    8336.2,
    8432.7,
    8519.2,
    8986.3,
    9337.9,
    9609.8,
    9834.6,
    10033.7,
    10964.5,
    11352.4,
    11539.2,
    11605.1,
    11689.1,
    11739.0,
    11784.6,
    11364.2,
    11440.3,
    11416.8,
    11274.6,
    11427.2,
    11415.1,
    11430.7,
    11557.9,
    11485.7,
    11584.4,
    11555.0,
    11542.9,
    11580.1,
    11545.4,
    11559.3,
    11564.2,
    11548.9,
    11568.3,
    11631.0,
    11640.7,
    11677.2,
    11726.1,
    11697.5,
    11722.2,
    11736.4,
    11706.2,
    11709.3,
    11706.0,
    11708.4,
    11705.4,
    11708.2,
    11708.6,
    11707.8,
    11709.1,
]

htod = [
    317.5,
    634.8,
    913.4,
    1171.3,
    1406.6,
    1632.3,
    1842.6,
    2013.5,
    2220.9,
    2383.9,
    2515.7,
    2706.0,
    2848.3,
    2979.4,
    3109.0,
    3220.8,
    3346.2,
    3456.4,
    3565.0,
    3658.8,
    3794.4,
    4011.6,
    4165.6,
    4312.9,
    4430.3,
    4560.4,
    4679.6,
    4782.1,
    4804.2,
    4976.3,
    5027.6,
    5134.2,
    5224.6,
    5298.3,
    5361.9,
    5662.8,
    5893.5,
    6059.0,
    6223.6,
    6365.1,
    6982.5,
    7250.2,
    7379.0,
    7426.0,
    7479.7,
    7519.3,
    7550.3,
    7287.0,
    7304.0,
    7316.8,
    7273.8,
    7271.5,
    7328.6,
    7352.7,
    7373.6,
    7396.0,
    7413.0,
    7444.9,
    7432.2,
    8442.1,
    9321.4,
    9319.0,
    10354.1,
    10354.7,
    11339.8,
    11548.8,
    11580.4,
    11569.9,
    11577.5,
    11553.3,
    11561.2,
    11559.3,
    11553.5,
    11588.3,
    11623.2,
    11607.5,
    11639.9,
    11647.8,
    11673.8,
    11686.4,
    11678.7,
]

dtod = [
    341.3,
    704.5,
    1026.5,
    1448.5,
    1713.3,
    2042.3,
    2397.0,
    2662.3,
    2969.0,
    3363.5,
    3939.4,
    4700.1,
    5049.7,
    5394.6,
    5818.3,
    6199.2,
    6572.4,
    7016.8,
    7333.0,
    7708.0,
    8497.1,
    9300.6,
    10547.8,
    10848.0,
    11019.0,
    12210.8,
    12756.6,
    13161.0,
    13789.7,
    14019.7,
    13951.6,
    14555.7,
    15339.9,
    16017.1,
    16748.0,
    19593.5,
    22647.3,
    26395.0,
    28784.2,
    32089.1,
    64102.6,
    80913.1,
    105214.4,
    115458.5,
    127947.0,
    140305.3,
    118985.3,
    105711.2,
    109342.2,
    119507.0,
    140101.1,
    146877.7,
    152427.4,
    156036.8,
    158614.5,
    160457.5,
    161828.8,
    162786.3,
    163838.0,
    164594.0,
    164999.4,
    165879.6,
    166193.4,
    166454.7,
    167214.4,
    167409.8,
    168245.3,
    168721.8,
    168829.5,
    169060.6,
    169422.2,
    169593.5,
    169695.8,
    169958.7,
    170517.7,
    170661.3,
    170761.3,
    171038.1,
    170994.5,
    171063.1,
    170529.6,
]
plt.plot(x,htod,'r-',label='Host-to-Device')
plt.plot(x,dtoh,'b-',label='Device-to-Host')
plt.plot(x,dtod,'g-',label='Device-to-Device')
plt.xlabel('Transfer Size (Bytes)')
plt.ylabel('Bandwidth (MB/s)')
plt.title('Bandwidth Analysis')
plt.legend()
plt.show()
